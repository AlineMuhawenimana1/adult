% Options for packages loaded elsewhere
% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrartcl}
\usepackage{xcolor}
\usepackage{amsmath,amssymb}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
% Make \paragraph and \subparagraph free-standing
\makeatletter
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}{
    \@ifstar
      \xxxParagraphStar
      \xxxParagraphNoStar
  }
  \newcommand{\xxxParagraphStar}[1]{\oldparagraph*{#1}\mbox{}}
  \newcommand{\xxxParagraphNoStar}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}{
    \@ifstar
      \xxxSubParagraphStar
      \xxxSubParagraphNoStar
  }
  \newcommand{\xxxSubParagraphStar}[1]{\oldsubparagraph*{#1}\mbox{}}
  \newcommand{\xxxSubParagraphNoStar}[1]{\oldsubparagraph{#1}\mbox{}}
\fi
\makeatother

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{% scales image to fit in text height/width
  \sbox\pandoc@box{#1}%
  \Gscale@div\@tempa{\textheight}{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
  \Gscale@div\@tempb{\linewidth}{\wd\pandoc@box}%
  \ifdim\@tempb\p@<\@tempa\p@\let\@tempa\@tempb\fi% select the smaller of both
  \ifdim\@tempa\p@<\p@\scalebox{\@tempa}{\usebox\pandoc@box}%
  \else\usebox{\pandoc@box}%
  \fi%
}
% Set default figure placement to htbp
\def\fps@figure{htbp}
\makeatother





\setlength{\emergencystretch}{3em} % prevent overfull lines

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}



 


\KOMAoption{captions}{tableheading}
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}


\author{}
\date{}
\begin{document}


In this notebook, we focus on data preparation, cleaning, and
preprocessing for the UCI Adult Income Dataset, a popular dataset often
used for classification tasks predicting whether an individual earns
more or less than \$50,000 annually based on demographic and
work-related attributes. Good data preprocessing is crucial for reliable
and interpretable results in machine learning and analytics workflows.
Here, we address common data issues such as missing values, duplicates,
and inconsistent categorical labels while creating derived features to
improve downstream analysis.

Good data preprocessing is crucial for reliable and interpretable
results in machine learning and analytics workflows. Here, we address
common data issues such as \textbf{missing values, duplicates, and
inconsistent categorical labels} while creating derived features to
improve downstream analysis.

We start by importing essential Python libraries for data handling and
manipulation.

\begin{itemize}
\item
  \texttt{pandas} for structured data operations.
\item
  \texttt{numpy} for numerical operations.
\item
  \texttt{os} for interacting with the operating system and directory
  structures.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# import libraries}
\ImportTok{import}\NormalTok{ pandas }\ImportTok{as}\NormalTok{ pd }
\ImportTok{import}\NormalTok{ numpy }\ImportTok{as}\NormalTok{ np  }
\ImportTok{import}\NormalTok{ os}
\end{Highlighting}
\end{Shaded}

\subsection{Define and Create Directory
Paths}\label{define-and-create-directory-paths}

To ensure reproducibility andorganized storage, we programmatically
create directories for:

\begin{itemize}
\tightlist
\item
  \textbf{raw data}
\item
  \textbf{processed data}
\item
  \textbf{results}
\item
  \textbf{documentation}
\end{itemize}

These directories will store intermediate and final outputs for
reproducibility.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#get working directories}
\NormalTok{current\_dir }\OperatorTok{=}\NormalTok{ os.getcwd() }
\CommentTok{\#Go one directory up to the root directory}
\NormalTok{project\_root\_dir }\OperatorTok{=}\NormalTok{ os.path.dirname(current\_dir) }
\NormalTok{project\_root\_dir}
\CommentTok{\# Define paths to the data folders}
\NormalTok{data\_dir }\OperatorTok{=}\NormalTok{ os.path.join(project\_root\_dir, }\StringTok{"Data"}\NormalTok{)}
\NormalTok{raw\_dir }\OperatorTok{=}\NormalTok{ os.path.join(data\_dir, }\StringTok{"raw"}\NormalTok{)}
\NormalTok{processed\_dir }\OperatorTok{=}\NormalTok{ os.path.join(data\_dir, }\StringTok{"processed"}\NormalTok{)}
\CommentTok{\# Define paths to results folder}
\NormalTok{results\_dir }\OperatorTok{=}\NormalTok{ os.path.join(project\_root\_dir, }\StringTok{"results"}\NormalTok{)}
\CommentTok{\#define paths to the docs folder}
\NormalTok{docs\_dir }\OperatorTok{=}\NormalTok{ os.path.join(project\_root\_dir,}\StringTok{"docs"}\NormalTok{)}

\CommentTok{\# Creates directories if they do not exist}
\NormalTok{os.makedirs(raw\_dir, exist\_ok }\OperatorTok{=} \VariableTok{True}\NormalTok{)}
\NormalTok{os.makedirs(processed\_dir, exist\_ok }\OperatorTok{=} \VariableTok{True}\NormalTok{)}
\NormalTok{os.makedirs(results\_dir, exist\_ok }\OperatorTok{=} \VariableTok{True}\NormalTok{)}
\NormalTok{os.makedirs(docs\_dir, exist\_ok }\OperatorTok{=} \VariableTok{True}\NormalTok{)}


\end{Highlighting}
\end{Shaded}

\section{Read in the data}\label{read-in-the-data}

We load the \textbf{Adult Income dataset} as a CSV file.

Key considerations here are:

\begin{itemize}
\tightlist
\item
  We treat \texttt{?} as missing values
  (\texttt{na\_values\ =\ \textquotesingle{}?\textquotesingle{}}).
\item
  We use \texttt{skipinitialspace\ =\ True} to remove extra spaces after
  delimeters which is common in text-based datasets.
\end{itemize}

After loading, we inspect the first few rows.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_data\_filename }\OperatorTok{=}\NormalTok{ os.path.join(raw\_dir, }\StringTok{"adult.csv"}\NormalTok{)}
\NormalTok{adult\_df }\OperatorTok{=}\NormalTok{ pd.read\_csv(adult\_data\_filename, header}\OperatorTok{=}\VariableTok{None}\NormalTok{, na\_values}\OperatorTok{=}\StringTok{\textquotesingle{}?\textquotesingle{}}\NormalTok{, skipinitialspace}\OperatorTok{=}\VariableTok{True}\NormalTok{)}
\NormalTok{adult\_df.head(}\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}llllllllllllllll@{}}
\toprule\noalign{}
& 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 & 13 & 14 \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
0 & 39 & State-gov & 77516 & Bachelors & 13 & Never-married &
Adm-clerical & Not-in-family & White & Male & 2174 & 0 & 40 &
United-States & \textless=50K \\
1 & 50 & Self-emp-not-inc & 83311 & Bachelors & 13 & Married-civ-spouse
& Exec-managerial & Husband & White & Male & 0 & 0 & 13 & United-States
& \textless=50K \\
2 & 38 & Private & 215646 & HS-grad & 9 & Divorced & Handlers-cleaners &
Not-in-family & White & Male & 0 & 0 & 40 & United-States &
\textless=50K \\
3 & 53 & Private & 234721 & 11th & 7 & Married-civ-spouse &
Handlers-cleaners & Husband & Black & Male & 0 & 0 & 40 & United-States
& \textless=50K \\
4 & 28 & Private & 338409 & Bachelors & 13 & Married-civ-spouse &
Prof-specialty & Wife & Black & Female & 0 & 0 & 40 & Cuba &
\textless=50K \\
5 & 37 & Private & 284582 & Masters & 14 & Married-civ-spouse &
Exec-managerial & Wife & White & Female & 0 & 0 & 40 & United-States &
\textless=50K \\
6 & 49 & Private & 160187 & 9th & 5 & Married-spouse-absent &
Other-service & Not-in-family & Black & Female & 0 & 0 & 16 & Jamaica &
\textless=50K \\
7 & 52 & Self-emp-not-inc & 209642 & HS-grad & 9 & Married-civ-spouse &
Exec-managerial & Husband & White & Male & 0 & 0 & 45 & United-States &
\textgreater50K \\
8 & 31 & Private & 45781 & Masters & 14 & Never-married & Prof-specialty
& Not-in-family & White & Female & 14084 & 0 & 50 & United-States &
\textgreater50K \\
9 & 42 & Private & 159449 & Bachelors & 13 & Married-civ-spouse &
Exec-managerial & Husband & White & Male & 5178 & 0 & 40 & United-States
& \textgreater50K \\
\end{longtable}

We also inspect the dataset's shape. We see that the data has
\emph{32,561} rows and \emph{15} columns.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.shape}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
(32561, 15)
\end{verbatim}

In addition, we check the data types using \texttt{.info}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.info()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 32561 entries, 0 to 32560
Data columns (total 15 columns):
 #   Column  Non-Null Count  Dtype 
---  ------  --------------  ----- 
 0   0       32561 non-null  int64 
 1   1       30725 non-null  object
 2   2       32561 non-null  int64 
 3   3       32561 non-null  object
 4   4       32561 non-null  int64 
 5   5       32561 non-null  object
 6   6       30718 non-null  object
 7   7       32561 non-null  object
 8   8       32561 non-null  object
 9   9       32561 non-null  object
 10  10      32561 non-null  int64 
 11  11      32561 non-null  int64 
 12  12      32561 non-null  int64 
 13  13      31978 non-null  object
 14  14      32561 non-null  object
dtypes: int64(6), object(9)
memory usage: 3.7+ MB
\end{verbatim}

\subsection{Data Cleaning}\label{data-cleaning}

\subsubsection{1. Assign proper column names to the
columns}\label{assign-proper-column-names-to-the-columns}

One of the most stricking things from the above inspection is that the
dataset lacks explicit column headers. We manually assign descriptive
meaningful column names based on the description of the
\href{https://archive.ics.uci.edu/dataset/2/adult}{dataset}. This is
critical for readability and interpretability in the subsequent steps.

\section{Data cleaning}\label{data-cleaning-1}

Assign proper column names to the columns

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.columns }\OperatorTok{=}\NormalTok{ [}
    \StringTok{"age"}\NormalTok{, }\StringTok{"workclass"}\NormalTok{, }\StringTok{"fnlwght"}\NormalTok{, }\StringTok{"education"}\NormalTok{, }\StringTok{"education\_num"}\NormalTok{, }
    \StringTok{"marital\_status"}\NormalTok{, }\StringTok{"occupation"}\NormalTok{, }\StringTok{"relationship"}\NormalTok{, }\StringTok{"race"}\NormalTok{, }\StringTok{"sex"}\NormalTok{, }
    \StringTok{"capital\_gain"}\NormalTok{, }\StringTok{"capital\_loss"}\NormalTok{, }\StringTok{"hours\_per\_week"}\NormalTok{, }
    \StringTok{"native\_country"}\NormalTok{, }\StringTok{"income"}
\NormalTok{]}
\NormalTok{adult\_df.head(}\DecValTok{10}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}llllllllllllllll@{}}
\toprule\noalign{}
& age & workclass & fnlwght & education & education\_num &
marital\_status & occupation & relationship & race & sex & capital\_gain
& capital\_loss & hours\_per\_week & native\_country & income \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
0 & 39 & State-gov & 77516 & Bachelors & 13 & Never-married &
Adm-clerical & Not-in-family & White & Male & 2174 & 0 & 40 &
United-States & \textless=50K \\
1 & 50 & Self-emp-not-inc & 83311 & Bachelors & 13 & Married-civ-spouse
& Exec-managerial & Husband & White & Male & 0 & 0 & 13 & United-States
& \textless=50K \\
2 & 38 & Private & 215646 & HS-grad & 9 & Divorced & Handlers-cleaners &
Not-in-family & White & Male & 0 & 0 & 40 & United-States &
\textless=50K \\
3 & 53 & Private & 234721 & 11th & 7 & Married-civ-spouse &
Handlers-cleaners & Husband & Black & Male & 0 & 0 & 40 & United-States
& \textless=50K \\
4 & 28 & Private & 338409 & Bachelors & 13 & Married-civ-spouse &
Prof-specialty & Wife & Black & Female & 0 & 0 & 40 & Cuba &
\textless=50K \\
5 & 37 & Private & 284582 & Masters & 14 & Married-civ-spouse &
Exec-managerial & Wife & White & Female & 0 & 0 & 40 & United-States &
\textless=50K \\
6 & 49 & Private & 160187 & 9th & 5 & Married-spouse-absent &
Other-service & Not-in-family & Black & Female & 0 & 0 & 16 & Jamaica &
\textless=50K \\
7 & 52 & Self-emp-not-inc & 209642 & HS-grad & 9 & Married-civ-spouse &
Exec-managerial & Husband & White & Male & 0 & 0 & 45 & United-States &
\textgreater50K \\
8 & 31 & Private & 45781 & Masters & 14 & Never-married & Prof-specialty
& Not-in-family & White & Female & 14084 & 0 & 50 & United-States &
\textgreater50K \\
9 & 42 & Private & 159449 & Bachelors & 13 & Married-civ-spouse &
Exec-managerial & Husband & White & Male & 5178 & 0 & 40 & United-States
& \textgreater50K \\
\end{longtable}

We inspect again to see whether they are properly assigned.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\setcounter{enumi}{1}
\tightlist
\item
  Understanding the dataset
\end{enumerate}

Before proceeding with the cleaning, we would like to understanding the
variables deeply. This would help guide the cleaning process. The
subsequent tables detail the types, meaning and values or ranges of the
variables in the dataset.

\textbf{Table 1: Summary table of the variables in the dataset}

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.1848}}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.1413}}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.4239}}
  >{\raggedright\arraybackslash}p{(\linewidth - 6\tabcolsep) * \real{0.2500}}@{}}
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Variable
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Type
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Description
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Values / Range (excluding nan)
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
age & Numeric & Age in years & 17 -- 90 \\
fnlwgt & Numeric & Final sampling weight & \textasciitilde12,285 --
1,484,705 \\
education\_num & Numeric & Education level in years & 1 -- 16 \\
capital\_gain & Numeric & Capital gain amounts (Profit from selling
assets above purchase price within the survey year (in USD)) & 0 --
99,999 \\
capital\_loss & Numeric & Capital loss amounts (Loss from selling assets
below purchase price within the survey year (in USD)) & 0 -- 4,356 \\
hours\_per\_week & Numeric & Weekly work hours & 1 -- 99 \\
workclass & Categorical & Type of employment & 8 categories \\
education & Categorical & Highest level of education achieved & 16
categories \\
marital\_status & Categorical & Marital status & 7 categories \\
occupation & Categorical & Type of job & 14 categories \\
relationship & Categorical & Relationship within household & 6
categories \\
race & Categorical & Ethnic/racial group & 5 categories \\
sex & Categorical & Gender & 2 categories \\
native\_country & Categorical & Country of origin & 41 categories \\
income & Categorical & Income category (target variable) & 2 categories:
\textless=50K, \textgreater50K \\
\end{longtable}

\textbf{Table 2: Categorical Variables Table} \textbar{} Variable
\textbar{} Unique Value \textbar{} Description \textbar{}
\textbar:----------------\textbar:--------------------\textbar:----------------------------------------------------------------------------\textbar{}
\textbar{} workclass \textbar{} Private \textbar{} Works for a private,
for-profit company \textbar{} \textbar{} \textbar{} Self-emp-not-inc
\textbar{} Self-employed without incorporated business status \textbar{}
\textbar{} \textbar{} Self-emp-inc \textbar{} Self-employed with an
incorporated business \textbar{} \textbar{} \textbar{} Federal-gov
\textbar{} Employed by the federal government \textbar{} \textbar{}
\textbar{} State-gov \textbar{} Employed by a state government
\textbar{} \textbar{} \textbar{} Local-gov \textbar{} Employed by a
local government \textbar{} \textbar{} \textbar{} Without-pay \textbar{}
Works without receiving pay (e.g.~unpaid family worker) \textbar{}
\textbar{} \textbar{} Never-worked \textbar{} Has never worked in their
lifetime \textbar{} \textbar{} education \textbar{} Bachelors \textbar{}
Bachelor's degree \textbar{} \textbar{} \textbar{} Some-college
\textbar{} Some college courses completed, no degree \textbar{}
\textbar{} \textbar{} 11th \textbar{} 11th grade completed \textbar{}
\textbar{} \textbar{} HS-grad \textbar{} High school graduate \textbar{}
\textbar{} \textbar{} Prof-school \textbar{} Professional school
(e.g.~law, medicine) \textbar{} \textbar{} \textbar{} Assoc-acdm
\textbar{} Associate degree (academic) \textbar{} \textbar{} \textbar{}
Assoc-voc \textbar{} Associate degree (vocational) \textbar{} \textbar{}
\textbar{} 9th \textbar{} 9th grade completed \textbar{} \textbar{}
\textbar{} 7th-8th \textbar{} 7th or 8th grade completed \textbar{}
\textbar{} \textbar{} 12th \textbar{} 12th grade, no diploma \textbar{}
\textbar{} \textbar{} Masters \textbar{} Master's degree \textbar{}
\textbar{} \textbar{} 1st-4th \textbar{} 1st to 4th grade completed
\textbar{} \textbar{} \textbar{} 10th \textbar{} 10th grade completed
\textbar{} \textbar{} \textbar{} Doctorate \textbar{} Doctoral degree
\textbar{} \textbar{} \textbar{} 5th-6th \textbar{} 5th or 6th grade
completed \textbar{} \textbar{} \textbar{} Preschool \textbar{}
Preschool education \textbar{} \textbar{} marital-status \textbar{}
Married-civ-spouse \textbar{} Married, living with spouse \textbar{}
\textbar{} \textbar{} Divorced \textbar{} Divorced legally \textbar{}
\textbar{} \textbar{} Never-married \textbar{} Never married \textbar{}
\textbar{} \textbar{} Separated \textbar{} Separated legally but not
divorced \textbar{} \textbar{} \textbar{} Widowed \textbar{} Spouse
deceased \textbar{} \textbar{} \textbar{}
Married-spouse-absent\textbar{} Married, spouse not present
(e.g.~estrangement) \textbar{} \textbar{} \textbar{} Married-AF-spouse
\textbar{} Married to a spouse who is a member of the Armed Forces
\textbar{} \textbar{} occupation \textbar{} Tech-support \textbar{}
Technical support jobs \textbar{} \textbar{} \textbar{} Craft-repair
\textbar{} Skilled manual trade and repair jobs \textbar{} \textbar{}
\textbar{} Other-service \textbar{} Services not classified elsewhere
\textbar{} \textbar{} \textbar{} Sales \textbar{} Sales-related jobs
\textbar{} \textbar{} \textbar{} Exec-managerial \textbar{} Executive
and managerial roles \textbar{} \textbar{} \textbar{} Prof-specialty
\textbar{} Professional specialty occupations (e.g.~scientist, lawyer)
\textbar{} \textbar{} \textbar{} Handlers-cleaners \textbar{} Manual
labor jobs involving cleaning, handling objects \textbar{} \textbar{}
\textbar{} Machine-op-inspct \textbar{} Machine operators, inspectors
\textbar{} \textbar{} \textbar{} Adm-clerical \textbar{} Administrative
and clerical jobs \textbar{} \textbar{} \textbar{} Farming-fishing
\textbar{} Agriculture, farming, fishing occupations \textbar{}
\textbar{} \textbar{} Transport-moving \textbar{} Transport and moving
equipment operators \textbar{} \textbar{} \textbar{} Priv-house-serv
\textbar{} Private household service jobs \textbar{} \textbar{}
\textbar{} Protective-serv \textbar{} Protective service jobs
(e.g.~security, law enforcement) \textbar{} \textbar{} \textbar{}
Armed-Forces \textbar{} Military service \textbar{} \textbar{}
relationship \textbar{} Wife \textbar{} Female spouse \textbar{}
\textbar{} \textbar{} Own-child \textbar{} Biological or adopted child
\textbar{} \textbar{} \textbar{} Husband \textbar{} Male spouse
\textbar{} \textbar{} \textbar{} Not-in-family \textbar{} Not part of a
family unit (e.g.~living alone) \textbar{} \textbar{} \textbar{}
Other-relative \textbar{} Other relative in household \textbar{}
\textbar{} \textbar{} Unmarried \textbar{} Single person, not married
\textbar{} \textbar{} race \textbar{} White \textbar{} White \textbar{}
\textbar{} \textbar{} Asian-Pac-Islander \textbar{} Asian or Pacific
Islander \textbar{} \textbar{} \textbar{} Amer-Indian-Eskimo \textbar{}
American Indian or Eskimo \textbar{} \textbar{} \textbar{} Other
\textbar{} Other race not listed \textbar{} \textbar{} \textbar{} Black
\textbar{} Black \textbar{} \textbar{} sex \textbar{} Female \textbar{}
Female \textbar{} \textbar{} \textbar{} Male \textbar{} Male \textbar{}
\textbar{} native-country \textbar{} United-States, Cambodia, England,
Puerto-Rico, Canada, Germany, Outlying-US(Guam-USVI-etc), India, Japan,
Greece, South, China, Cuba, Iran, Honduras, Philippines, Italy, Poland,
Jamaica, Vietnam, Mexico, Portugal, Ireland, France, Dominican-Republic,
Laos, Ecuador, Taiwan, Haiti, Columbia, Hungary, Guatemala, Nicaragua,
Scotland, Thailand, Yugoslavia, El-Salvador, Trinidad-Tobago, Peru,
Hong, Holland-Netherlands \textbar{} \textbar{} \textbar{} income
\textbar{} \textless=50K \textbar{} Income less than or equal to USD
50,000 \textbar{} \textbar{} \textbar{} \textgreater50K \textbar{}
Income greater than USD 50,000 \textbar{}

np.unique(adult\_df.age.to\_list())

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{np.unique(adult\_df.workclass.to\_list())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
array(['Federal-gov', 'Local-gov', 'Never-worked', 'Private',
       'Self-emp-inc', 'Self-emp-not-inc', 'State-gov', 'Without-pay',
       'nan'], dtype='<U32')
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{np.unique(adult\_df.fnlwght.to\_list())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
array([  12285,   13769,   14878, ..., 1366120, 1455435, 1484705])
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{np.unique(adult\_df.education.to\_list())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
array(['10th', '11th', '12th', '1st-4th', '5th-6th', '7th-8th', '9th',
       'Assoc-acdm', 'Assoc-voc', 'Bachelors', 'Doctorate', 'HS-grad',
       'Masters', 'Preschool', 'Prof-school', 'Some-college'],
      dtype='<U12')
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{np.unique(adult\_df.education\_num.to\_list())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16])
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.columns}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Index(['age', 'workclass', 'fnlwght', 'education', 'education_num',
       'marital_status', 'occupation', 'relationship', 'race', 'sex',
       'capital_gain', 'capital_loss', 'hours_per_week', 'native_country',
       'income'],
      dtype='object')
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{np.unique(adult\_df.marital\_status.to\_list())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
array(['Divorced', 'Married-AF-spouse', 'Married-civ-spouse',
       'Married-spouse-absent', 'Never-married', 'Separated', 'Widowed'],
      dtype='<U21')
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{np.unique(adult\_df.sex.to\_list())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
array(['Female', 'Male'], dtype='<U6')
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{np.unique(adult\_df.capital\_loss.to\_list())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
array([   0,  155,  213,  323,  419,  625,  653,  810,  880,  974, 1092,
       1138, 1258, 1340, 1380, 1408, 1411, 1485, 1504, 1539, 1564, 1573,
       1579, 1590, 1594, 1602, 1617, 1628, 1648, 1651, 1668, 1669, 1672,
       1719, 1721, 1726, 1735, 1740, 1741, 1755, 1762, 1816, 1825, 1844,
       1848, 1876, 1887, 1902, 1944, 1974, 1977, 1980, 2001, 2002, 2042,
       2051, 2057, 2080, 2129, 2149, 2163, 2174, 2179, 2201, 2205, 2206,
       2231, 2238, 2246, 2258, 2267, 2282, 2339, 2352, 2377, 2392, 2415,
       2444, 2457, 2467, 2472, 2489, 2547, 2559, 2603, 2754, 2824, 3004,
       3683, 3770, 3900, 4356])
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{np.unique(adult\_df.hours\_per\_week.to\_list())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34,
       35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51,
       52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68,
       70, 72, 73, 74, 75, 76, 77, 78, 80, 81, 82, 84, 85, 86, 87, 88, 89,
       90, 91, 92, 94, 95, 96, 97, 98, 99])
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{np.unique(adult\_df.native\_country.to\_list())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
array(['Cambodia', 'Canada', 'China', 'Columbia', 'Cuba',
       'Dominican-Republic', 'Ecuador', 'El-Salvador', 'England',
       'France', 'Germany', 'Greece', 'Guatemala', 'Haiti',
       'Holand-Netherlands', 'Honduras', 'Hong', 'Hungary', 'India',
       'Iran', 'Ireland', 'Italy', 'Jamaica', 'Japan', 'Laos', 'Mexico',
       'Nicaragua', 'Outlying-US(Guam-USVI-etc)', 'Peru', 'Philippines',
       'Poland', 'Portugal', 'Puerto-Rico', 'Scotland', 'South', 'Taiwan',
       'Thailand', 'Trinadad&Tobago', 'United-States', 'Vietnam',
       'Yugoslavia', 'nan'], dtype='<U32')
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{np.unique(adult\_df.income.to\_list())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
array(['<=50K', '>50K'], dtype='<U5')
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{np.unique(adult\_df.marital\_status.to\_list())}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
array(['Divorced', 'Married-AF-spouse', 'Married-civ-spouse',
       'Married-spouse-absent', 'Never-married', 'Separated', 'Widowed'],
      dtype='<U21')
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.isnull()}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}llllllllllllllll@{}}
\toprule\noalign{}
& age & workclass & fnlwght & education & education\_num &
marital\_status & occupation & relationship & race & sex & capital\_gain
& capital\_loss & hours\_per\_week & native\_country & income \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
0 & False & False & False & False & False & False & False & False &
False & False & False & False & False & False & False \\
1 & False & False & False & False & False & False & False & False &
False & False & False & False & False & False & False \\
2 & False & False & False & False & False & False & False & False &
False & False & False & False & False & False & False \\
3 & False & False & False & False & False & False & False & False &
False & False & False & False & False & False & False \\
4 & False & False & False & False & False & False & False & False &
False & False & False & False & False & False & False \\
... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... &
... & ... & ... & ... \\
32556 & False & False & False & False & False & False & False & False &
False & False & False & False & False & False & False \\
32557 & False & False & False & False & False & False & False & False &
False & False & False & False & False & False & False \\
32558 & False & False & False & False & False & False & False & False &
False & False & False & False & False & False & False \\
32559 & False & False & False & False & False & False & False & False &
False & False & False & False & False & False & False \\
32560 & False & False & False & False & False & False & False & False &
False & False & False & False & False & False & False \\
\end{longtable}

\subsection{2. Deal with null values}\label{deal-with-null-values}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.isnull().}\BuiltInTok{sum}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
age                  0
workclass         1836
fnlwght              0
education            0
education_num        0
marital_status       0
occupation        1843
relationship         0
race                 0
sex                  0
capital_gain         0
capital_loss         0
hours_per_week       0
native_country     583
income               0
dtype: int64
\end{verbatim}

Using \texttt{.isnull().sum()}, we identify columns with missing values.
They are:

\begin{itemize}
\tightlist
\item
  \texttt{workclass} with 1,836 missing values
\item
  \texttt{occupation} with 1,843 missing values
\item
  \texttt{native\_country} with 583 missing values
\end{itemize}

We address these by:

\begin{itemize}
\tightlist
\item
  Imputing categorical missing values with \texttt{Unknown} for the
  columns \texttt{workclass} and \texttt{occupation}
\item
  Imputing categorical missing values with \texttt{Other} for the column
  \texttt{native\_country}
\end{itemize}

This has been done to preserve data consistency while acknowledging
uncertainity.

We inspect one more time to ensure we don't have any missing values.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df[}\StringTok{\textquotesingle{}workclass\textquotesingle{}}\NormalTok{]}\OperatorTok{=}\NormalTok{adult\_df[}\StringTok{\textquotesingle{}workclass\textquotesingle{}}\NormalTok{].fillna(}\StringTok{\textquotesingle{}unknown\textquotesingle{}}\NormalTok{)}
\NormalTok{adult\_df[}\StringTok{\textquotesingle{}native\_country\textquotesingle{}}\NormalTok{]}\OperatorTok{=}\NormalTok{adult\_df[}\StringTok{\textquotesingle{}native\_country\textquotesingle{}}\NormalTok{].fillna(}\StringTok{\textquotesingle{}Other\textquotesingle{}}\NormalTok{)}
\NormalTok{adult\_df[}\StringTok{\textquotesingle{}occupation\textquotesingle{}}\NormalTok{]}\OperatorTok{=}\NormalTok{adult\_df[}\StringTok{\textquotesingle{}occupation\textquotesingle{}}\NormalTok{].fillna(}\StringTok{\textquotesingle{}unknown\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.isnull().}\BuiltInTok{sum}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
age               0
workclass         0
fnlwght           0
education         0
education_num     0
marital_status    0
occupation        0
relationship      0
race              0
sex               0
capital_gain      0
capital_loss      0
hours_per_week    0
native_country    0
income            0
dtype: int64
\end{verbatim}

\subsubsection{3. Removing Duplicates}\label{removing-duplicates}

Duplicates can distort statistical summaries and model performance.
Using \texttt{.duplicated().sum()}, we count duplicate records.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.duplicated().}\BuiltInTok{sum}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
24
\end{verbatim}

We then inspect the duplicated records.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df[adult\_df.duplicated(keep}\OperatorTok{=}\VariableTok{False}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}llllllllllllllll@{}}
\toprule\noalign{}
& age & workclass & fnlwght & education & education\_num &
marital\_status & occupation & relationship & race & sex & capital\_gain
& capital\_loss & hours\_per\_week & native\_country & income \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
2303 & 90 & Private & 52386 & Some-college & 10 & Never-married &
Other-service & Not-in-family & Asian-Pac-Islander & Male & 0 & 0 & 35 &
United-States & \textless=50K \\
3917 & 19 & Private & 251579 & Some-college & 10 & Never-married &
Other-service & Own-child & White & Male & 0 & 0 & 14 & United-States &
\textless=50K \\
4325 & 25 & Private & 308144 & Bachelors & 13 & Never-married &
Craft-repair & Not-in-family & White & Male & 0 & 0 & 40 & Mexico &
\textless=50K \\
4767 & 21 & Private & 250051 & Some-college & 10 & Never-married &
Prof-specialty & Own-child & White & Female & 0 & 0 & 10 & United-States
& \textless=50K \\
4881 & 25 & Private & 308144 & Bachelors & 13 & Never-married &
Craft-repair & Not-in-family & White & Male & 0 & 0 & 40 & Mexico &
\textless=50K \\
4940 & 38 & Private & 207202 & HS-grad & 9 & Married-civ-spouse &
Machine-op-inspct & Husband & White & Male & 0 & 0 & 48 & United-States
& \textgreater50K \\
5104 & 90 & Private & 52386 & Some-college & 10 & Never-married &
Other-service & Not-in-family & Asian-Pac-Islander & Male & 0 & 0 & 35 &
United-States & \textless=50K \\
5579 & 27 & Private & 255582 & HS-grad & 9 & Never-married &
Machine-op-inspct & Not-in-family & White & Female & 0 & 0 & 40 &
United-States & \textless=50K \\
5805 & 20 & Private & 107658 & Some-college & 10 & Never-married &
Tech-support & Not-in-family & White & Female & 0 & 0 & 10 &
United-States & \textless=50K \\
5842 & 25 & Private & 195994 & 1st-4th & 2 & Never-married &
Priv-house-serv & Not-in-family & White & Female & 0 & 0 & 40 &
Guatemala & \textless=50K \\
6990 & 19 & Private & 138153 & Some-college & 10 & Never-married &
Adm-clerical & Own-child & White & Female & 0 & 0 & 10 & United-States &
\textless=50K \\
7053 & 49 & Self-emp-not-inc & 43479 & Some-college & 10 &
Married-civ-spouse & Craft-repair & Husband & White & Male & 0 & 0 & 40
& United-States & \textless=50K \\
7920 & 49 & Private & 31267 & 7th-8th & 4 & Married-civ-spouse &
Craft-repair & Husband & White & Male & 0 & 0 & 40 & United-States &
\textless=50K \\
8080 & 21 & Private & 243368 & Preschool & 1 & Never-married &
Farming-fishing & Not-in-family & White & Male & 0 & 0 & 50 & Mexico &
\textless=50K \\
8679 & 28 & Private & 274679 & Masters & 14 & Never-married &
Prof-specialty & Not-in-family & White & Male & 0 & 0 & 50 &
United-States & \textless=50K \\
9171 & 21 & Private & 250051 & Some-college & 10 & Never-married &
Prof-specialty & Own-child & White & Female & 0 & 0 & 10 & United-States
& \textless=50K \\
10367 & 42 & Private & 204235 & Some-college & 10 & Married-civ-spouse &
Prof-specialty & Husband & White & Male & 0 & 0 & 40 & United-States &
\textgreater50K \\
11631 & 20 & Private & 107658 & Some-college & 10 & Never-married &
Tech-support & Not-in-family & White & Female & 0 & 0 & 10 &
United-States & \textless=50K \\
11965 & 46 & Private & 133616 & Some-college & 10 & Divorced &
Adm-clerical & Unmarried & White & Female & 0 & 0 & 40 & United-States &
\textless=50K \\
13084 & 25 & Private & 195994 & 1st-4th & 2 & Never-married &
Priv-house-serv & Not-in-family & White & Female & 0 & 0 & 40 &
Guatemala & \textless=50K \\
15059 & 21 & Private & 243368 & Preschool & 1 & Never-married &
Farming-fishing & Not-in-family & White & Male & 0 & 0 & 50 & Mexico &
\textless=50K \\
15189 & 19 & Private & 146679 & Some-college & 10 & Never-married &
Exec-managerial & Own-child & Black & Male & 0 & 0 & 30 & United-States
& \textless=50K \\
16297 & 46 & Private & 173243 & HS-grad & 9 & Married-civ-spouse &
Craft-repair & Husband & White & Male & 0 & 0 & 40 & United-States &
\textless=50K \\
16846 & 35 & Private & 379959 & HS-grad & 9 & Divorced & Other-service &
Not-in-family & White & Female & 0 & 0 & 40 & United-States &
\textless=50K \\
16975 & 30 & Private & 144593 & HS-grad & 9 & Never-married &
Other-service & Not-in-family & Black & Male & 0 & 0 & 40 & Other &
\textless=50K \\
17040 & 46 & Private & 173243 & HS-grad & 9 & Married-civ-spouse &
Craft-repair & Husband & White & Male & 0 & 0 & 40 & United-States &
\textless=50K \\
17673 & 19 & Private & 97261 & HS-grad & 9 & Never-married &
Farming-fishing & Not-in-family & White & Male & 0 & 0 & 40 &
United-States & \textless=50K \\
17916 & 44 & Private & 367749 & Bachelors & 13 & Never-married &
Prof-specialty & Not-in-family & White & Female & 0 & 0 & 45 & Mexico &
\textless=50K \\
18555 & 30 & Private & 144593 & HS-grad & 9 & Never-married &
Other-service & Not-in-family & Black & Male & 0 & 0 & 40 & Other &
\textless=50K \\
18698 & 19 & Private & 97261 & HS-grad & 9 & Never-married &
Farming-fishing & Not-in-family & White & Male & 0 & 0 & 40 &
United-States & \textless=50K \\
21103 & 23 & Private & 240137 & 5th-6th & 3 & Never-married &
Handlers-cleaners & Not-in-family & White & Male & 0 & 0 & 55 & Mexico &
\textless=50K \\
21318 & 19 & Private & 138153 & Some-college & 10 & Never-married &
Adm-clerical & Own-child & White & Female & 0 & 0 & 10 & United-States &
\textless=50K \\
21490 & 19 & Private & 146679 & Some-college & 10 & Never-married &
Exec-managerial & Own-child & Black & Male & 0 & 0 & 30 & United-States
& \textless=50K \\
21875 & 49 & Private & 31267 & 7th-8th & 4 & Married-civ-spouse &
Craft-repair & Husband & White & Male & 0 & 0 & 40 & United-States &
\textless=50K \\
22300 & 25 & Private & 195994 & 1st-4th & 2 & Never-married &
Priv-house-serv & Not-in-family & White & Female & 0 & 0 & 40 &
Guatemala & \textless=50K \\
22367 & 44 & Private & 367749 & Bachelors & 13 & Never-married &
Prof-specialty & Not-in-family & White & Female & 0 & 0 & 45 & Mexico &
\textless=50K \\
22494 & 49 & Self-emp-not-inc & 43479 & Some-college & 10 &
Married-civ-spouse & Craft-repair & Husband & White & Male & 0 & 0 & 40
& United-States & \textless=50K \\
25624 & 39 & Private & 30916 & HS-grad & 9 & Married-civ-spouse &
Craft-repair & Husband & White & Male & 0 & 0 & 40 & United-States &
\textless=50K \\
25872 & 23 & Private & 240137 & 5th-6th & 3 & Never-married &
Handlers-cleaners & Not-in-family & White & Male & 0 & 0 & 55 & Mexico &
\textless=50K \\
26313 & 28 & Private & 274679 & Masters & 14 & Never-married &
Prof-specialty & Not-in-family & White & Male & 0 & 0 & 50 &
United-States & \textless=50K \\
28230 & 27 & Private & 255582 & HS-grad & 9 & Never-married &
Machine-op-inspct & Not-in-family & White & Female & 0 & 0 & 40 &
United-States & \textless=50K \\
28522 & 42 & Private & 204235 & Some-college & 10 & Married-civ-spouse &
Prof-specialty & Husband & White & Male & 0 & 0 & 40 & United-States &
\textgreater50K \\
28846 & 39 & Private & 30916 & HS-grad & 9 & Married-civ-spouse &
Craft-repair & Husband & White & Male & 0 & 0 & 40 & United-States &
\textless=50K \\
29157 & 38 & Private & 207202 & HS-grad & 9 & Married-civ-spouse &
Machine-op-inspct & Husband & White & Male & 0 & 0 & 48 & United-States
& \textgreater50K \\
30845 & 46 & Private & 133616 & Some-college & 10 & Divorced &
Adm-clerical & Unmarried & White & Female & 0 & 0 & 40 & United-States &
\textless=50K \\
31993 & 19 & Private & 251579 & Some-college & 10 & Never-married &
Other-service & Own-child & White & Male & 0 & 0 & 14 & United-States &
\textless=50K \\
32404 & 35 & Private & 379959 & HS-grad & 9 & Divorced & Other-service &
Not-in-family & White & Female & 0 & 0 & 40 & United-States &
\textless=50K \\
\end{longtable}

Finally, we remove them with \texttt{.drop\_duplicates()}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df }\OperatorTok{=}\NormalTok{ adult\_df.drop\_duplicates()}
\end{Highlighting}
\end{Shaded}

We can confirm that we have no duplicates left in the dataset at this
juncture.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.duplicated().}\BuiltInTok{sum}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
0
\end{verbatim}

We also inspect the current shape of the dataset and see that we have
\emph{32,537} rows and \emph{15} columns.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.shape}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
(32537, 15)
\end{verbatim}

\paragraph{5. standardize categorical
variables}\label{standardize-categorical-variables}

\emph{remove any leading or trailing spaces and convert the strings to
lowercase} To prepare categorical variables for consistent processing,
we first of all remove extra spaces and convert them to lowercase. This
step ensures categorical variables are clean and consistently organized.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.dtypes }\OperatorTok{==} \BuiltInTok{object}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
age               False
workclass          True
fnlwght           False
education          True
education_num     False
marital_status     True
occupation         True
relationship       True
race               True
sex                True
capital_gain      False
capital_loss      False
hours_per_week    False
native_country     True
income             True
dtype: bool
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.columns}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Index(['age', 'workclass', 'fnlwght', 'education', 'education_num',
       'marital_status', 'occupation', 'relationship', 'race', 'sex',
       'capital_gain', 'capital_loss', 'hours_per_week', 'native_country',
       'income'],
      dtype='object')
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{categorical\_cols }\OperatorTok{=}\NormalTok{ adult\_df.columns[adult\_df.dtypes }\OperatorTok{==} \BuiltInTok{object}\NormalTok{]}
\NormalTok{categorical\_cols}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Index(['workclass', 'education', 'marital_status', 'occupation',
       'relationship', 'race', 'sex', 'native_country', 'income'],
      dtype='object')
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{categorical\_cols }\OperatorTok{=}\NormalTok{ adult\_df.columns[adult\_df.dtypes }\OperatorTok{==} \BuiltInTok{object}\NormalTok{]}

\ControlFlowTok{for}\NormalTok{ col }\KeywordTok{in}\NormalTok{ categorical\_cols: }
\NormalTok{    adult\_df.loc[:, col] }\OperatorTok{=}\NormalTok{ adult\_df.loc[:, col].}\BuiltInTok{str}\NormalTok{.strip().}\BuiltInTok{str}\NormalTok{.lower()}

\NormalTok{categorical\_cols}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Index(['workclass', 'education', 'marital_status', 'occupation',
       'relationship', 'race', 'sex', 'native_country', 'income'],
      dtype='object')
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}llllllllllllllll@{}}
\toprule\noalign{}
& age & workclass & fnlwght & education & education\_num &
marital\_status & occupation & relationship & race & sex & capital\_gain
& capital\_loss & hours\_per\_week & native\_country & income \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
0 & 39 & state-gov & 77516 & bachelors & 13 & never-married &
adm-clerical & not-in-family & white & male & 2174 & 0 & 40 &
united-states & \textless=50k \\
1 & 50 & self-emp-not-inc & 83311 & bachelors & 13 & married-civ-spouse
& exec-managerial & husband & white & male & 0 & 0 & 13 & united-states
& \textless=50k \\
2 & 38 & private & 215646 & hs-grad & 9 & divorced & handlers-cleaners &
not-in-family & white & male & 0 & 0 & 40 & united-states &
\textless=50k \\
3 & 53 & private & 234721 & 11th & 7 & married-civ-spouse &
handlers-cleaners & husband & black & male & 0 & 0 & 40 & united-states
& \textless=50k \\
4 & 28 & private & 338409 & bachelors & 13 & married-civ-spouse &
prof-specialty & wife & black & female & 0 & 0 & 40 & cuba &
\textless=50k \\
... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... &
... & ... & ... & ... \\
32556 & 27 & private & 257302 & assoc-acdm & 12 & married-civ-spouse &
tech-support & wife & white & female & 0 & 0 & 38 & united-states &
\textless=50k \\
32557 & 40 & private & 154374 & hs-grad & 9 & married-civ-spouse &
machine-op-inspct & husband & white & male & 0 & 0 & 40 & united-states
& \textgreater50k \\
32558 & 58 & private & 151910 & hs-grad & 9 & widowed & adm-clerical &
unmarried & white & female & 0 & 0 & 40 & united-states &
\textless=50k \\
32559 & 22 & private & 201490 & hs-grad & 9 & never-married &
adm-clerical & own-child & white & male & 0 & 0 & 20 & united-states &
\textless=50k \\
32560 & 52 & self-emp-inc & 287927 & hs-grad & 9 & married-civ-spouse &
exec-managerial & wife & white & female & 15024 & 0 & 40 & united-states
& \textgreater50k \\
\end{longtable}

\textbf{Re-code the \texttt{workclass} column}

We re-code the \texttt{workclass} column to broader categories like
\texttt{government}, \texttt{private}, \texttt{self-employed}, etc.
Table 3 shows the new encoding:

\textbf{Table 3: Re-encoding of the \texttt{workclass} column}

\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
Old categories & New Categories \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\texttt{state-gov} & \texttt{government} \\
\texttt{local-gov} & \texttt{government} \\
\texttt{federal-gov} & \texttt{government} \\
\texttt{self-emp-not-inc} & \texttt{self-employed} \\
\texttt{self-emp-inc} & \texttt{self-employed} \\
\texttt{never-worked} & \texttt{unemployed} \\
\texttt{without-pay} & \texttt{voluntary} \\
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df[}\StringTok{\textquotesingle{}workclass\textquotesingle{}}\NormalTok{].unique()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
array(['state-gov', 'self-emp-not-inc', 'private', 'federal-gov',
       'local-gov', 'unknown', 'self-emp-inc', 'without-pay',
       'never-worked'], dtype=object)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.loc[:,}\StringTok{\textquotesingle{}workclass\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ adult\_df[}\StringTok{\textquotesingle{}workclass\textquotesingle{}}\NormalTok{].replace(\{}
    \StringTok{\textquotesingle{}state{-}gov\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}government\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}loc{-}gov\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}government\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}federal{-}gov\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}government\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}self{-}emp{-}not{-}inc\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}self{-}employed\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}self{-}emp{-}inc\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}self{-}employed\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}never{-}worked\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}unemployed\textquotesingle{}}\NormalTok{,  }
    \StringTok{\textquotesingle{}without{-}pay\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}voluntary\textquotesingle{}}
\NormalTok{\})}
\NormalTok{adult\_df}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}llllllllllllllll@{}}
\toprule\noalign{}
& age & workclass & fnlwght & education & education\_num &
marital\_status & occupation & relationship & race & sex & capital\_gain
& capital\_loss & hours\_per\_week & native\_country & income \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
0 & 39 & government & 77516 & bachelors & 13 & never-married &
adm-clerical & not-in-family & white & male & 2174 & 0 & 40 &
united-states & \textless=50k \\
1 & 50 & self-employed & 83311 & bachelors & 13 & married-civ-spouse &
exec-managerial & husband & white & male & 0 & 0 & 13 & united-states &
\textless=50k \\
2 & 38 & private & 215646 & hs-grad & 9 & divorced & handlers-cleaners &
not-in-family & white & male & 0 & 0 & 40 & united-states &
\textless=50k \\
3 & 53 & private & 234721 & 11th & 7 & married-civ-spouse &
handlers-cleaners & husband & black & male & 0 & 0 & 40 & united-states
& \textless=50k \\
4 & 28 & private & 338409 & bachelors & 13 & married-civ-spouse &
prof-specialty & wife & black & female & 0 & 0 & 40 & cuba &
\textless=50k \\
... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... &
... & ... & ... & ... \\
32556 & 27 & private & 257302 & assoc-acdm & 12 & married-civ-spouse &
tech-support & wife & white & female & 0 & 0 & 38 & united-states &
\textless=50k \\
32557 & 40 & private & 154374 & hs-grad & 9 & married-civ-spouse &
machine-op-inspct & husband & white & male & 0 & 0 & 40 & united-states
& \textgreater50k \\
32558 & 58 & private & 151910 & hs-grad & 9 & widowed & adm-clerical &
unmarried & white & female & 0 & 0 & 40 & united-states &
\textless=50k \\
32559 & 22 & private & 201490 & hs-grad & 9 & never-married &
adm-clerical & own-child & white & male & 0 & 0 & 20 & united-states &
\textless=50k \\
32560 & 52 & self-employed & 287927 & hs-grad & 9 & married-civ-spouse &
exec-managerial & wife & white & female & 15024 & 0 & 40 & united-states
& \textgreater50k \\
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.loc[:,}\StringTok{\textquotesingle{}education\_level\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ adult\_df.loc[:,}\StringTok{\textquotesingle{}education\textquotesingle{}}\NormalTok{].}\BuiltInTok{map}\NormalTok{(\{}
    \StringTok{\textquotesingle{}bachelors\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}tertiary\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}masters\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}tertiary\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}doctorate\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}tertiary\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}prof{-}school\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}tertiary\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}some{-}college\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}some college\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}assoc{-}acdm\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}associate\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}assoc{-}voc\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}associate\textquotesingle{}}\NormalTok{,  }
    \StringTok{\textquotesingle{}hs{-}grad\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}secondary{-}school graduate\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}12th\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}secondary school\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}11th\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}secondary school\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}10th\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}secondary school\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}9th\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}secondary school\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}7th{-}8th\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}primary\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}5th{-}6th\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}primary\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}1st{-}4th\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}primary\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}preschool\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}preschool\textquotesingle{}}\NormalTok{, }
    
    
\NormalTok{\})}
\NormalTok{adult\_df}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}lllllllllllllllll@{}}
\toprule\noalign{}
& age & workclass & fnlwght & education & education\_num &
marital\_status & occupation & relationship & race & sex & capital\_gain
& capital\_loss & hours\_per\_week & native\_country & income &
education\_level \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
0 & 39 & government & 77516 & bachelors & 13 & never-married &
adm-clerical & not-in-family & white & male & 2174 & 0 & 40 &
united-states & \textless=50k & tertiary \\
1 & 50 & self-employed & 83311 & bachelors & 13 & married-civ-spouse &
exec-managerial & husband & white & male & 0 & 0 & 13 & united-states &
\textless=50k & tertiary \\
2 & 38 & private & 215646 & hs-grad & 9 & divorced & handlers-cleaners &
not-in-family & white & male & 0 & 0 & 40 & united-states &
\textless=50k & secondary-school graduate \\
3 & 53 & private & 234721 & 11th & 7 & married-civ-spouse &
handlers-cleaners & husband & black & male & 0 & 0 & 40 & united-states
& \textless=50k & secondary school \\
4 & 28 & private & 338409 & bachelors & 13 & married-civ-spouse &
prof-specialty & wife & black & female & 0 & 0 & 40 & cuba &
\textless=50k & tertiary \\
... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... &
... & ... & ... & ... & ... \\
32556 & 27 & private & 257302 & assoc-acdm & 12 & married-civ-spouse &
tech-support & wife & white & female & 0 & 0 & 38 & united-states &
\textless=50k & associate \\
32557 & 40 & private & 154374 & hs-grad & 9 & married-civ-spouse &
machine-op-inspct & husband & white & male & 0 & 0 & 40 & united-states
& \textgreater50k & secondary-school graduate \\
32558 & 58 & private & 151910 & hs-grad & 9 & widowed & adm-clerical &
unmarried & white & female & 0 & 0 & 40 & united-states & \textless=50k
& secondary-school graduate \\
32559 & 22 & private & 201490 & hs-grad & 9 & never-married &
adm-clerical & own-child & white & male & 0 & 0 & 20 & united-states &
\textless=50k & secondary-school graduate \\
32560 & 52 & self-employed & 287927 & hs-grad & 9 & married-civ-spouse &
exec-managerial & wife & white & female & 15024 & 0 & 40 & united-states
& \textgreater50k & secondary-school graduate \\
\end{longtable}

\textbf{Re-code the \texttt{education} column}

We create a new colum \texttt{education\_level} with broader education
groups. The mapping from \texttt{education} to \texttt{education\_level}
is as follows:

\textbf{Table 4: Mapping from \texttt{education} to
\texttt{education\_level}}

\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
Education & Education Level \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\texttt{bachelors} & \texttt{tertiary} \\
\texttt{masters} & \texttt{tertiary} \\
\texttt{doctorate} & \texttt{tertiary} \\
\texttt{prof-school} & \texttt{tertiary} \\
\texttt{some-college} & \texttt{some\ college} \\
\texttt{assoc-acdm} & \texttt{associate} \\
\texttt{assoc-voc} & \texttt{associate} \\
\texttt{hs-grad} & \texttt{secondary-school\ graduate} \\
\texttt{12th} & \texttt{secondary} \\
\texttt{11th} & \texttt{secondary} \\
\texttt{10th} & \texttt{secondary} \\
\texttt{9th} & \texttt{secondary} \\
\texttt{7th-8th} & \texttt{primary} \\
\texttt{5th-6th} & \texttt{primary} \\
\texttt{1st-4th} & \texttt{primary} \\
\texttt{preschool} & \texttt{preschool} \\
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df[}\StringTok{\textquotesingle{}education\_level\textquotesingle{}}\NormalTok{].unique()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
array(['tertiary', 'secondary-school graduate', 'secondary school',
       'some college', 'associate', 'primary', 'preschool'], dtype=object)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df[}\StringTok{\textquotesingle{}marital\_status\textquotesingle{}}\NormalTok{].unique()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
array(['never-married', 'married-civ-spouse', 'divorced',
       'married-spouse-absent', 'separated', 'married-af-spouse',
       'widowed'], dtype=object)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.loc[:,}\StringTok{\textquotesingle{}marital\_status\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ adult\_df[}\StringTok{\textquotesingle{}marital\_status\textquotesingle{}}\NormalTok{].replace(\{}
    \StringTok{\textquotesingle{}never{-}married\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}single\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}married{-}civ{-}spouse\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}married\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}married{-}spouse{-}absent\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}divorced or separated\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}divorced\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}divorced or separated\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}separated\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}divorced or separated\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}married\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}divorced or separated\textquotesingle{}}\NormalTok{,  }
\NormalTok{\})}
\NormalTok{adult\_df}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}lllllllllllllllll@{}}
\toprule\noalign{}
& age & workclass & fnlwght & education & education\_num &
marital\_status & occupation & relationship & race & sex & capital\_gain
& capital\_loss & hours\_per\_week & native\_country & income &
education\_level \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
0 & 39 & government & 77516 & bachelors & 13 & single & adm-clerical &
not-in-family & white & male & 2174 & 0 & 40 & united-states &
\textless=50k & tertiary \\
1 & 50 & self-employed & 83311 & bachelors & 13 & married &
exec-managerial & husband & white & male & 0 & 0 & 13 & united-states &
\textless=50k & tertiary \\
2 & 38 & private & 215646 & hs-grad & 9 & divorced or separated &
handlers-cleaners & not-in-family & white & male & 0 & 0 & 40 &
united-states & \textless=50k & secondary-school graduate \\
3 & 53 & private & 234721 & 11th & 7 & married & handlers-cleaners &
husband & black & male & 0 & 0 & 40 & united-states & \textless=50k &
secondary school \\
4 & 28 & private & 338409 & bachelors & 13 & married & prof-specialty &
wife & black & female & 0 & 0 & 40 & cuba & \textless=50k & tertiary \\
... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... &
... & ... & ... & ... & ... \\
32556 & 27 & private & 257302 & assoc-acdm & 12 & married & tech-support
& wife & white & female & 0 & 0 & 38 & united-states & \textless=50k &
associate \\
32557 & 40 & private & 154374 & hs-grad & 9 & married &
machine-op-inspct & husband & white & male & 0 & 0 & 40 & united-states
& \textgreater50k & secondary-school graduate \\
32558 & 58 & private & 151910 & hs-grad & 9 & widowed & adm-clerical &
unmarried & white & female & 0 & 0 & 40 & united-states & \textless=50k
& secondary-school graduate \\
32559 & 22 & private & 201490 & hs-grad & 9 & single & adm-clerical &
own-child & white & male & 0 & 0 & 20 & united-states & \textless=50k &
secondary-school graduate \\
32560 & 52 & self-employed & 287927 & hs-grad & 9 & married &
exec-managerial & wife & white & female & 15024 & 0 & 40 & united-states
& \textgreater50k & secondary-school graduate \\
\end{longtable}

\textbf{Re-code the \texttt{marital\_status} column}

The categories in\texttt{marital\_status} are simplified into
\texttt{single}, \texttt{married}, \texttt{divorced\ or\ separated} and
\texttt{widowed}. See Table 5 for details.

\textbf{Table 5: Re-encoding of the \texttt{marital\_status} column}

\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
Old categories & New categories \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\texttt{never-married} & \texttt{single} \\
\texttt{married-civ-spouse} & \texttt{married} \\
\texttt{married-spouse-absent} & \texttt{divorced\ or\ separated} \\
\texttt{divorced} & \texttt{divorced\ or\ separated} \\
\texttt{separated} & \texttt{divorced\ or\ separated} \\
\texttt{married-af-spouse} & \texttt{married} \\
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.loc[:,}\StringTok{\textquotesingle{}marital\_status\textquotesingle{}}\NormalTok{].unique()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
array(['single', 'married', 'divorced or separated', 'married-af-spouse',
       'widowed'], dtype=object)
\end{verbatim}

\textbf{Re-code the \texttt{occupation} column}

A new column, \texttt{occupation\_grouped}, is created. This new column
groups the occupations into the categories \texttt{white\ collar},
\texttt{blue\ collar}, \texttt{service}, \texttt{unknown} and
\texttt{military}. The exact mapping is illustrated in Table 6.

\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
Occupation & Occupation Grouped \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\texttt{adm-clerical} & \texttt{white\ collar} \\
\texttt{exec-managerial} & \texttt{white\ collar} \\
\texttt{handlers-cleaners} & \texttt{blue\ collar} \\
\texttt{prof-specialty} & \texttt{white\ collar} \\
\texttt{other-service} & \texttt{service} \\
\texttt{sales} & \texttt{white\ collar} \\
\texttt{craft-repair} & \texttt{blue\ collar} \\
\texttt{transport-moving} & \texttt{blue\ collar} \\
\texttt{farming-fishing} & \texttt{blue\ collar} \\
\texttt{machine-op-inspct} & \texttt{blue\ collar} \\
\texttt{tech-support} & \texttt{white\ collar} \\
\texttt{protective-serv} & \texttt{service} \\
\texttt{armed-forces} & \texttt{military} \\
\texttt{priv-house-serv} & \texttt{service} \\
\texttt{unknown} & \texttt{unknown} \\
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df[}\StringTok{\textquotesingle{}occupation\textquotesingle{}}\NormalTok{].unique()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
array(['adm-clerical', 'exec-managerial', 'handlers-cleaners',
       'prof-specialty', 'other-service', 'sales', 'craft-repair',
       'transport-moving', 'farming-fishing', 'machine-op-inspct',
       'tech-support', 'unknown', 'protective-serv', 'armed-forces',
       'priv-house-serv'], dtype=object)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.loc[:,}\StringTok{\textquotesingle{}occupation\_group\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ adult\_df[}\StringTok{\textquotesingle{}occupation\textquotesingle{}}\NormalTok{].}\BuiltInTok{map}\NormalTok{(\{}
    \StringTok{\textquotesingle{}adm{-}clerical\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}white collar\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}exec{-}managerial\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}white collar\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}handlers{-}cleaners\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}blue collar\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}prof{-}specialty\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}white collar\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}other{-}service\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}service\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}sales\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}white collar\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}craft{-}repair\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}blue collar\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}transport{-}moving\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}blue collar\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}farming{-}fishing\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}blue collar\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}machine{-}op{-}inspct\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}blue collar\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}tech{-}support\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}white collar\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}unknown\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}unknown\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}protective{-}serv\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}service\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}armed{-}forces\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}military\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}priv{-}house{-}serv\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}service\textquotesingle{}}\NormalTok{,}
\NormalTok{\})}
\NormalTok{adult\_df}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
C:\Users\Dione\AppData\Local\Temp\ipykernel_9948\4152506489.py:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  adult_df.loc[:,'occupation_group'] = adult_df['occupation'].map({
\end{verbatim}

\begin{longtable}[]{@{}llllllllllllllllll@{}}
\toprule\noalign{}
& age & workclass & fnlwght & education & education\_num &
marital\_status & occupation & relationship & race & sex & capital\_gain
& capital\_loss & hours\_per\_week & native\_country & income &
education\_level & occupation\_group \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
0 & 39 & government & 77516 & bachelors & 13 & single & adm-clerical &
not-in-family & white & male & 2174 & 0 & 40 & united-states &
\textless=50k & tertiary & white collar \\
1 & 50 & self-employed & 83311 & bachelors & 13 & married &
exec-managerial & husband & white & male & 0 & 0 & 13 & united-states &
\textless=50k & tertiary & white collar \\
2 & 38 & private & 215646 & hs-grad & 9 & divorced or separated &
handlers-cleaners & not-in-family & white & male & 0 & 0 & 40 &
united-states & \textless=50k & secondary-school graduate & blue
collar \\
3 & 53 & private & 234721 & 11th & 7 & married & handlers-cleaners &
husband & black & male & 0 & 0 & 40 & united-states & \textless=50k &
secondary school & blue collar \\
4 & 28 & private & 338409 & bachelors & 13 & married & prof-specialty &
wife & black & female & 0 & 0 & 40 & cuba & \textless=50k & tertiary &
white collar \\
... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... &
... & ... & ... & ... & ... & ... \\
32556 & 27 & private & 257302 & assoc-acdm & 12 & married & tech-support
& wife & white & female & 0 & 0 & 38 & united-states & \textless=50k &
associate & white collar \\
32557 & 40 & private & 154374 & hs-grad & 9 & married &
machine-op-inspct & husband & white & male & 0 & 0 & 40 & united-states
& \textgreater50k & secondary-school graduate & blue collar \\
32558 & 58 & private & 151910 & hs-grad & 9 & widowed & adm-clerical &
unmarried & white & female & 0 & 0 & 40 & united-states & \textless=50k
& secondary-school graduate & white collar \\
32559 & 22 & private & 201490 & hs-grad & 9 & single & adm-clerical &
own-child & white & male & 0 & 0 & 20 & united-states & \textless=50k &
secondary-school graduate & white collar \\
32560 & 52 & self-employed & 287927 & hs-grad & 9 & married &
exec-managerial & wife & white & female & 15024 & 0 & 40 & united-states
& \textgreater50k & secondary-school graduate & white collar \\
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df[}\StringTok{\textquotesingle{}occupation\_group\textquotesingle{}}\NormalTok{].unique()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
array(['white collar', 'blue collar', 'service', 'unknown', 'military'],
      dtype=object)
\end{verbatim}

\textbf{Re-code the \texttt{relationship} column}

We normalize the \texttt{race} column to indicate roles within a family
or individual status.

Table 7 shows the re-encoding:

\textbf{Table 7: Re-encoding of the \texttt{race} column}

\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
Old relationship & New relationship \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\texttt{wife} & \texttt{female\ spouse} \\
\texttt{own-child} & \texttt{child} \\
\texttt{not-in-family} & \texttt{single} \\
\texttt{other-relative} & \texttt{extended\ relative} \\
\texttt{unmarried} & \texttt{single} \\
\texttt{husband} & \texttt{male\ spouse} \\
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{ adult\_df.loc[:,}\StringTok{\textquotesingle{}relationship\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ adult\_df[}\StringTok{\textquotesingle{}relationship\textquotesingle{}}\NormalTok{].replace(\{}
    \StringTok{\textquotesingle{}not{-}in{-}family\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}single\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}husband\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}male spouse\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}wife\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}female spouse\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}own{-}child\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}child\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}unmarried\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}single\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}other{-}relative\textquotesingle{}}\NormalTok{ : }\StringTok{\textquotesingle{}extended relative\textquotesingle{}}\NormalTok{,}
\NormalTok{\})}
\NormalTok{adult\_df}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}llllllllllllllllll@{}}
\toprule\noalign{}
& age & workclass & fnlwght & education & education\_num &
marital\_status & occupation & relationship & race & sex & capital\_gain
& capital\_loss & hours\_per\_week & native\_country & income &
education\_level & occupation\_group \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
0 & 39 & government & 77516 & bachelors & 13 & single & adm-clerical &
single & white & male & 2174 & 0 & 40 & united-states & \textless=50k &
tertiary & white collar \\
1 & 50 & self-employed & 83311 & bachelors & 13 & married &
exec-managerial & male spouse & white & male & 0 & 0 & 13 &
united-states & \textless=50k & tertiary & white collar \\
2 & 38 & private & 215646 & hs-grad & 9 & divorced or separated &
handlers-cleaners & single & white & male & 0 & 0 & 40 & united-states &
\textless=50k & secondary-school graduate & blue collar \\
3 & 53 & private & 234721 & 11th & 7 & married & handlers-cleaners &
male spouse & black & male & 0 & 0 & 40 & united-states & \textless=50k
& secondary school & blue collar \\
4 & 28 & private & 338409 & bachelors & 13 & married & prof-specialty &
female spouse & black & female & 0 & 0 & 40 & cuba & \textless=50k &
tertiary & white collar \\
... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... &
... & ... & ... & ... & ... & ... \\
32556 & 27 & private & 257302 & assoc-acdm & 12 & married & tech-support
& female spouse & white & female & 0 & 0 & 38 & united-states &
\textless=50k & associate & white collar \\
32557 & 40 & private & 154374 & hs-grad & 9 & married &
machine-op-inspct & male spouse & white & male & 0 & 0 & 40 &
united-states & \textgreater50k & secondary-school graduate & blue
collar \\
32558 & 58 & private & 151910 & hs-grad & 9 & widowed & adm-clerical &
single & white & female & 0 & 0 & 40 & united-states & \textless=50k &
secondary-school graduate & white collar \\
32559 & 22 & private & 201490 & hs-grad & 9 & single & adm-clerical &
child & white & male & 0 & 0 & 20 & united-states & \textless=50k &
secondary-school graduate & white collar \\
32560 & 52 & self-employed & 287927 & hs-grad & 9 & married &
exec-managerial & female spouse & white & female & 15024 & 0 & 40 &
united-states & \textgreater50k & secondary-school graduate & white
collar \\
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df[}\StringTok{\textquotesingle{}relationship\textquotesingle{}}\NormalTok{].unique()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
array(['single', 'male spouse', 'female spouse', 'child',
       'extended relative'], dtype=object)
\end{verbatim}

\textbf{Re-code the \texttt{race} column}

We standardize the \texttt{race} column to have more clear names. Table
8 shows the record values that were re-encoded:

\textbf{Table 8: Re-encoding of the \texttt{race} column}

\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
Old categories & New categories \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\texttt{asian-pac-islander} & \texttt{asian\ or\ pacific\ islander} \\
\texttt{amer-indian-eskimo} & \texttt{american\ indian\ or\ eskimo} \\
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.loc[:,}\StringTok{\textquotesingle{}race\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ adult\_df[}\StringTok{\textquotesingle{}race\textquotesingle{}}\NormalTok{].replace(\{}
    \StringTok{\textquotesingle{}White\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}white\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Asian{-}Pac{-}Islander\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}asian or pacific islander\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Amer{-}Indian{-}Eskimo\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}american indian or eskimo\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Black\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}black\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}Other\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}other\textquotesingle{}}
\NormalTok{\})}
\NormalTok{adult\_df}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}llllllllllllllllll@{}}
\toprule\noalign{}
& age & workclass & fnlwght & education & education\_num &
marital\_status & occupation & relationship & race & sex & capital\_gain
& capital\_loss & hours\_per\_week & native\_country & income &
education\_level & occupation\_group \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
0 & 39 & government & 77516 & bachelors & 13 & single & adm-clerical &
single & white & male & 2174 & 0 & 40 & united-states & \textless=50k &
tertiary & white collar \\
1 & 50 & self-employed & 83311 & bachelors & 13 & married &
exec-managerial & male spouse & white & male & 0 & 0 & 13 &
united-states & \textless=50k & tertiary & white collar \\
2 & 38 & private & 215646 & hs-grad & 9 & divorced or separated &
handlers-cleaners & single & white & male & 0 & 0 & 40 & united-states &
\textless=50k & secondary-school graduate & blue collar \\
3 & 53 & private & 234721 & 11th & 7 & married & handlers-cleaners &
male spouse & black & male & 0 & 0 & 40 & united-states & \textless=50k
& secondary school & blue collar \\
4 & 28 & private & 338409 & bachelors & 13 & married & prof-specialty &
female spouse & black & female & 0 & 0 & 40 & cuba & \textless=50k &
tertiary & white collar \\
... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... &
... & ... & ... & ... & ... & ... \\
32556 & 27 & private & 257302 & assoc-acdm & 12 & married & tech-support
& female spouse & white & female & 0 & 0 & 38 & united-states &
\textless=50k & associate & white collar \\
32557 & 40 & private & 154374 & hs-grad & 9 & married &
machine-op-inspct & male spouse & white & male & 0 & 0 & 40 &
united-states & \textgreater50k & secondary-school graduate & blue
collar \\
32558 & 58 & private & 151910 & hs-grad & 9 & widowed & adm-clerical &
single & white & female & 0 & 0 & 40 & united-states & \textless=50k &
secondary-school graduate & white collar \\
32559 & 22 & private & 201490 & hs-grad & 9 & single & adm-clerical &
child & white & male & 0 & 0 & 20 & united-states & \textless=50k &
secondary-school graduate & white collar \\
32560 & 52 & self-employed & 287927 & hs-grad & 9 & married &
exec-managerial & female spouse & white & female & 15024 & 0 & 40 &
united-states & \textgreater50k & secondary-school graduate & white
collar \\
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df[}\StringTok{\textquotesingle{}race\textquotesingle{}}\NormalTok{].unique()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
array(['white', 'black', 'asian-pac-islander', 'amer-indian-eskimo',
       'other'], dtype=object)
\end{verbatim}

\textbf{Re-code the \texttt{native\_country} column}

We create a new colum \texttt{native\_region} which maps
\texttt{native\_country} to geographical regions (e.g.,
\texttt{north\ america}, \texttt{asia}, etc.). The mapping is as
follows:

\textbf{Table 9: Mapping from \texttt{native\_country} to
\texttt{native\_region}}

\begin{longtable}[]{@{}ll@{}}
\toprule\noalign{}
native\_country & native\_region \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
\texttt{united-states} & \texttt{north\ america} \\
\texttt{canada} & \texttt{north\ america} \\
\texttt{puerto-rico} & \texttt{north\ america} \\
\texttt{outlying-us(guam-usvi-etc)} & \texttt{north\ america} \\
\texttt{mexico} & \texttt{north\ america} \\
\texttt{cuba} & \texttt{central\ america} \\
\texttt{jamaica} & \texttt{central\ america} \\
\texttt{honduras} & \texttt{central\ america} \\
\texttt{dominican-republic} & \texttt{central\ america} \\
\texttt{el-salvador} & \texttt{central\ america} \\
\texttt{guatemala} & \texttt{central\ america} \\
\texttt{nicaragua} & \texttt{central\ america} \\
\texttt{trinadad\&tobago} & \texttt{central\ america} \\
\texttt{haiti} & \texttt{central\ america} \\
\texttt{columbia} & \texttt{south\ america} \\
\texttt{ecuador} & \texttt{south\ america} \\
\texttt{peru} & \texttt{south\ america} \\
\texttt{south} & \texttt{south\ america} \\
\texttt{india} & \texttt{asia} \\
\texttt{china} & \texttt{asia} \\
\texttt{iran} & \texttt{asia} \\
\texttt{japan} & \texttt{asia} \\
\texttt{philippines} & \texttt{asia} \\
\texttt{cambodia} & \texttt{asia} \\
\texttt{thailand} & \texttt{asia} \\
\texttt{laos} & \texttt{asia} \\
\texttt{taiwan} & \texttt{asia} \\
\texttt{vietnam} & \texttt{asia} \\
\texttt{hong} & \texttt{asia} \\
\texttt{england} & \texttt{europe} \\
\texttt{germany} & \texttt{europe} \\
\texttt{france} & \texttt{europe} \\
\texttt{italy} & \texttt{europe} \\
\texttt{poland} & \texttt{europe} \\
\texttt{portugal} & \texttt{europe} \\
\texttt{yugoslavia} & \texttt{europe} \\
\texttt{scotland} & \texttt{europe} \\
\texttt{greece} & \texttt{europe} \\
\texttt{ireland} & \texttt{europe} \\
\texttt{hungary} & \texttt{europe} \\
\texttt{holand-netherlands} & \texttt{europe} \\
\texttt{other} & \texttt{other} \\
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df[}\StringTok{\textquotesingle{}native\_country\textquotesingle{}}\NormalTok{].unique()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
array(['united-states', 'cuba', 'jamaica', 'india', 'other', 'mexico',
       'south', 'puerto-rico', 'honduras', 'england', 'canada', 'germany',
       'iran', 'philippines', 'italy', 'poland', 'columbia', 'cambodia',
       'thailand', 'ecuador', 'laos', 'taiwan', 'haiti', 'portugal',
       'dominican-republic', 'el-salvador', 'france', 'guatemala',
       'china', 'japan', 'yugoslavia', 'peru',
       'outlying-us(guam-usvi-etc)', 'scotland', 'trinadad&tobago',
       'greece', 'nicaragua', 'vietnam', 'hong', 'ireland', 'hungary',
       'holand-netherlands'], dtype=object)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.loc[:,}\StringTok{\textquotesingle{}native\_region\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ adult\_df.loc[:,}\StringTok{\textquotesingle{}native\_country\textquotesingle{}}\NormalTok{].}\BuiltInTok{map}\NormalTok{(\{}
    \StringTok{\textquotesingle{}united{-}states\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}north america\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}cambodia\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}asia\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}england\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}europe\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}puerto{-}rico\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}north america\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}canada\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}north america\textquotesingle{}}\NormalTok{,}
     \StringTok{\textquotesingle{}germany\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}europe\textquotesingle{}}\NormalTok{,}
     \StringTok{\textquotesingle{}outlying{-}us(guam{-}usvi{-}etc)\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}north america\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}india\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}asia\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}japan\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}asia\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}greece\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}europe\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}south\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}south america\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}china\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}asia\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}cuba\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}central america\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}iran\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}asia\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}honduras\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}central america\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}philippines\textquotesingle{}}\NormalTok{: }\StringTok{\textquotesingle{}asia\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}italy\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}europe\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}poland\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}europe\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}jamaica\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}central america\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}vietnam\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}asia\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}mexico\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}north america\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}portugal\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}europe\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}ireland\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}europe\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}france\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}europe\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}dominican{-}republic\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}central america\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}laos\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}asia\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}ecuador\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}south america\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}taiwan\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}asia\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}haiti\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}central america\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}columbia\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}south america\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}hungary\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}europe\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}guatemala\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}central america\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}nicaragua\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}central america\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}scotland\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}europe\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}thailand\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}asia\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}yugoslavia\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}europe\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}el{-}salvador\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}central america\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}trinadad\&tobago\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}central america\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}peru\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}south america\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}hong\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}asia\textquotesingle{}}\NormalTok{,}
    \StringTok{\textquotesingle{}other\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}other\textquotesingle{}}\NormalTok{, }
    \StringTok{\textquotesingle{}holand{-}netherlands\textquotesingle{}}\NormalTok{:}\StringTok{\textquotesingle{}europe\textquotesingle{}}
\NormalTok{\})}

\NormalTok{adult\_df}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}llllllllllllllllll@{}}
\toprule\noalign{}
& age & workclass & fnlwght & education & education\_num &
marital\_status & occupation & relationship & race & sex & capital\_gain
& capital\_loss & hours\_per\_week & native\_country & income &
education\_level & native\_region \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
0 & 39 & government & 77516 & bachelors & 13 & never-married &
adm-clerical & not-in-family & white & male & 2174 & 0 & 40 &
united-states & \textless=50k & tertiary & north america \\
1 & 50 & self-employed & 83311 & bachelors & 13 & married-civ-spouse &
exec-managerial & husband & white & male & 0 & 0 & 13 & united-states &
\textless=50k & tertiary & north america \\
2 & 38 & private & 215646 & hs-grad & 9 & divorced & handlers-cleaners &
not-in-family & white & male & 0 & 0 & 40 & united-states &
\textless=50k & secondary-school graduate & north america \\
3 & 53 & private & 234721 & 11th & 7 & married-civ-spouse &
handlers-cleaners & husband & black & male & 0 & 0 & 40 & united-states
& \textless=50k & secondary school & north america \\
4 & 28 & private & 338409 & bachelors & 13 & married-civ-spouse &
prof-specialty & wife & black & female & 0 & 0 & 40 & cuba &
\textless=50k & tertiary & central america \\
... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... & ... &
... & ... & ... & ... & ... & ... \\
32556 & 27 & private & 257302 & assoc-acdm & 12 & married-civ-spouse &
tech-support & wife & white & female & 0 & 0 & 38 & united-states &
\textless=50k & associate & north america \\
32557 & 40 & private & 154374 & hs-grad & 9 & married-civ-spouse &
machine-op-inspct & husband & white & male & 0 & 0 & 40 & united-states
& \textgreater50k & secondary-school graduate & north america \\
32558 & 58 & private & 151910 & hs-grad & 9 & widowed & adm-clerical &
unmarried & white & female & 0 & 0 & 40 & united-states & \textless=50k
& secondary-school graduate & north america \\
32559 & 22 & private & 201490 & hs-grad & 9 & never-married &
adm-clerical & own-child & white & male & 0 & 0 & 20 & united-states &
\textless=50k & secondary-school graduate & north america \\
32560 & 52 & self-employed & 287927 & hs-grad & 9 & married-civ-spouse &
exec-managerial & wife & white & female & 15024 & 0 & 40 & united-states
& \textgreater50k & secondary-school graduate & north america \\
\end{longtable}

\subsubsection{\texorpdfstring{6. Create age groups based on the
\texttt{age}
column}{6. Create age groups based on the age column}}\label{create-age-groups-based-on-the-age-column}

Age is binned into groups such as \texttt{\textless{}18},
\texttt{18-25}, \(\cdots\), \texttt{76+} to facilitate easier
demographic analysis.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df[}\StringTok{\textquotesingle{}age\textquotesingle{}}\NormalTok{].unique().}\BuiltInTok{max}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
90
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bins }\OperatorTok{=}\NormalTok{ [}\DecValTok{0}\NormalTok{,}\DecValTok{18}\NormalTok{,}\DecValTok{25}\NormalTok{,}\DecValTok{35}\NormalTok{,}\DecValTok{45}\NormalTok{,}\DecValTok{60}\NormalTok{,}\DecValTok{75}\NormalTok{,}\DecValTok{100}\NormalTok{]}
\NormalTok{labels }\OperatorTok{=}\NormalTok{ [}\StringTok{\textquotesingle{}\textless{}18\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}18{-}25\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}26{-}35\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}36{-}45\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}46{-}60\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}61{-}75\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}76+\textquotesingle{}}\NormalTok{]}
\NormalTok{adult\_df[}\StringTok{\textquotesingle{}age\_group\textquotesingle{}}\NormalTok{] }\OperatorTok{=}\NormalTok{ pd.cut(adult\_df[}\StringTok{\textquotesingle{}age\textquotesingle{}}\NormalTok{], bins }\OperatorTok{=}\NormalTok{ bins, labels}\OperatorTok{=}\NormalTok{labels, right}\OperatorTok{=}\VariableTok{True}\NormalTok{, include\_lowest}\OperatorTok{=} \VariableTok{False}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
C:\Users\Dione\AppData\Local\Temp\ipykernel_9948\3814012320.py:3: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  adult_df['age_group'] = pd.cut(adult_df['age'], bins = bins, labels=labels, right=True, include_lowest= False)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pd.cut([}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{], bins}\OperatorTok{=}\NormalTok{[}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{],right}\OperatorTok{=}\VariableTok{True}\NormalTok{, include\_lowest}\OperatorTok{=}\VariableTok{False}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[NaN, (0.0, 1.0], (1.0, 2.0]]
Categories (2, interval[int64, right]): [(0, 1] < (1, 2]]
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df[}\StringTok{\textquotesingle{}age\_group\textquotesingle{}}\NormalTok{].unique()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
['36-45', '46-60', '26-35', '18-25', '<18', '76+', '61-75']
Categories (7, object): ['<18' < '18-25' < '26-35' < '36-45' < '46-60' < '61-75' < '76+']
\end{verbatim}

\subsubsection{7. Drop unnecessary
columns}\label{drop-unnecessary-columns}

After recoding, some columns such as \texttt{education},
\texttt{native\_country} and \texttt{occupation} become redundant. We
drop them to avoid multicollinearity and simplify our dataset. We
notably retain the \texttt{age} column in case there is need to model it
as a continuous variable.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.columns}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Index(['age', 'workclass', 'fnlwght', 'education_num', 'marital_status',
       'relationship', 'race', 'sex', 'capital_gain', 'capital_loss',
       'hours_per_week', 'income', 'education_level', 'occupation_group',
       'continent', 'age_group'],
      dtype='object')
\end{verbatim}

\subsection{Save the Clean Dataset}\label{save-the-clean-dataset}

Before saving the clean dataset, we re-inspect it to ensure no new
issues have risen up due to re-encoding. We first of all inspect the
shape of the dataset. We see that we have \emph{32,537} rows and
\emph{16} columns. This means that there is a new column,
\texttt{age\_group}, added to the original dataset.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.shape}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
(32537, 16)
\end{verbatim}

We confirm that there are no null values.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.isnull().}\BuiltInTok{sum}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
age                 0
workclass           0
fnlwght             0
education_num       0
marital_status      0
relationship        0
race                0
sex                 0
capital_gain        0
capital_loss        0
hours_per_week      0
income              0
education_level     0
occupation_group    0
continent           0
age_group           0
dtype: int64
\end{verbatim}

However, we note that there are new duplicated values given that we
merged some categories in the re-encoding process. We inadvertently drop
the duplicates.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.duplicated().}\BuiltInTok{sum}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
24
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df[adult\_df.duplicated(keep}\OperatorTok{=}\VariableTok{False}\NormalTok{)]}
\end{Highlighting}
\end{Shaded}

\begin{longtable}[]{@{}lllllllllllllllll@{}}
\toprule\noalign{}
& age & workclass & fnlwght & education\_num & marital\_status &
relationship & race & sex & capital\_gain & capital\_loss &
hours\_per\_week & income & education\_level & occupation\_group &
continent & age\_group \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
531 & 26 & private & 108658 & 9 & single & single & white & male & 0 & 0
& 40 & \textless=50k & secondary-school graduate & blue collar & north
america & 26-35 \\
594 & 23 & private & 117789 & 13 & single & child & white & female & 0 &
0 & 40 & \textless=50k & tertiary & white collar & north america &
18-25 \\
2896 & 46 & private & 271828 & 9 & married & male spouse & white & male
& 0 & 0 & 40 & \textgreater50k & secondary-school graduate & blue collar
& north america & 46-60 \\
3261 & 26 & private & 108658 & 9 & single & single & white & male & 0 &
0 & 40 & \textless=50k & secondary-school graduate & blue collar & north
america & 26-35 \\
3586 & 28 & private & 50814 & 9 & single & single & white & female & 0 &
0 & 40 & \textless=50k & secondary-school graduate & white collar &
north america & 26-35 \\
3692 & 46 & private & 271828 & 9 & married & male spouse & white & male
& 0 & 0 & 40 & \textgreater50k & secondary-school graduate & blue collar
& north america & 46-60 \\
3960 & 43 & private & 174575 & 10 & divorced or separated & single &
white & male & 0 & 0 & 45 & \textless=50k & some college & white collar
& north america & 36-45 \\
4511 & 24 & private & 140001 & 13 & single & single & white & male & 0 &
0 & 40 & \textless=50k & tertiary & white collar & north america &
18-25 \\
5110 & 21 & private & 118693 & 10 & single & child & white & male & 0 &
0 & 40 & \textless=50k & some college & blue collar & north america &
18-25 \\
5805 & 20 & private & 107658 & 10 & single & single & white & female & 0
& 0 & 10 & \textless=50k & some college & white collar & north america &
18-25 \\
6403 & 26 & private & 174921 & 13 & single & single & white & female & 0
& 0 & 40 & \textless=50k & tertiary & white collar & north america &
26-35 \\
6763 & 44 & private & 104196 & 14 & married & male spouse & white & male
& 0 & 0 & 45 & \textgreater50k & tertiary & white collar & north america
& 36-45 \\
7713 & 28 & private & 50814 & 9 & single & single & white & female & 0 &
0 & 40 & \textless=50k & secondary-school graduate & white collar &
north america & 26-35 \\
8342 & 33 & private & 198211 & 9 & married & male spouse & white & male
& 0 & 0 & 40 & \textless=50k & secondary-school graduate & white collar
& north america & 26-35 \\
8794 & 33 & private & 198211 & 9 & married & male spouse & white & male
& 0 & 0 & 40 & \textless=50k & secondary-school graduate & white collar
& north america & 26-35 \\
9680 & 29 & private & 115677 & 13 & single & single & white & male & 0 &
0 & 40 & \textless=50k & tertiary & white collar & north america &
26-35 \\
9980 & 29 & private & 115677 & 13 & single & single & white & male & 0 &
0 & 40 & \textless=50k & tertiary & white collar & north america &
26-35 \\
10302 & 25 & private & 182866 & 9 & single & child & white & male & 0 &
0 & 40 & \textless=50k & secondary-school graduate & blue collar & north
america & 18-25 \\
11331 & 23 & private & 117789 & 13 & single & child & white & female & 0
& 0 & 40 & \textless=50k & tertiary & white collar & north america &
18-25 \\
12180 & 26 & private & 174921 & 13 & single & single & white & female &
0 & 0 & 40 & \textless=50k & tertiary & white collar & north america &
26-35 \\
12199 & 27 & private & 183523 & 13 & single & single & white & male & 0
& 0 & 45 & \textless=50k & tertiary & white collar & north america &
26-35 \\
12233 & 22 & government & 262819 & 10 & single & single & white & female
& 0 & 0 & 40 & \textless=50k & some college & white collar & north
america & 18-25 \\
12596 & 28 & private & 205337 & 9 & married & male spouse & white & male
& 0 & 0 & 40 & \textless=50k & secondary-school graduate & blue collar &
north america & 26-35 \\
13396 & 31 & private & 209538 & 6 & married & male spouse & white & male
& 0 & 0 & 40 & \textless=50k & secondary school & blue collar & north
america & 26-35 \\
17202 & 25 & private & 178478 & 13 & single & child & white & female & 0
& 0 & 40 & \textless=50k & tertiary & white collar & north america &
18-25 \\
17630 & 33 & private & 136331 & 9 & married & male spouse & white & male
& 0 & 0 & 40 & \textless=50k & secondary-school graduate & blue collar &
north america & 26-35 \\
18147 & 58 & private & 205410 & 9 & married & male spouse & white & male
& 0 & 0 & 40 & \textless=50k & secondary-school graduate & blue collar &
north america & 46-60 \\
19098 & 42 & private & 177989 & 9 & married & male spouse & white & male
& 0 & 0 & 40 & \textless=50k & secondary-school graduate & blue collar &
north america & 36-45 \\
20373 & 28 & private & 205337 & 9 & married & male spouse & white & male
& 0 & 0 & 40 & \textless=50k & secondary-school graduate & blue collar &
north america & 26-35 \\
21264 & 38 & private & 108907 & 9 & divorced or separated & single &
white & male & 0 & 0 & 40 & \textless=50k & secondary-school graduate &
blue collar & other & 36-45 \\
21488 & 20 & private & 107658 & 10 & single & single & white & female &
0 & 0 & 10 & \textless=50k & some college & white collar & north america
& 18-25 \\
22840 & 56 & private & 220187 & 10 & married & male spouse & white &
male & 0 & 0 & 45 & \textgreater50k & some college & white collar &
north america & 46-60 \\
23520 & 22 & government & 262819 & 10 & single & single & white & female
& 0 & 0 & 40 & \textless=50k & some college & white collar & north
america & 18-25 \\
23674 & 21 & private & 118693 & 10 & single & child & white & male & 0 &
0 & 40 & \textless=50k & some college & blue collar & north america &
18-25 \\
23785 & 24 & private & 140001 & 13 & single & single & white & male & 0
& 0 & 40 & \textless=50k & tertiary & white collar & north america &
18-25 \\
23851 & 25 & private & 367306 & 10 & single & child & white & female & 0
& 0 & 40 & \textless=50k & some college & white collar & north america &
18-25 \\
24400 & 44 & private & 104196 & 14 & married & male spouse & white &
male & 0 & 0 & 45 & \textgreater50k & tertiary & white collar & north
america & 36-45 \\
24942 & 25 & private & 178478 & 13 & single & child & white & female & 0
& 0 & 40 & \textless=50k & tertiary & white collar & north america &
18-25 \\
25467 & 31 & private & 209538 & 6 & married & male spouse & white & male
& 0 & 0 & 40 & \textless=50k & secondary school & blue collar & north
america & 26-35 \\
26004 & 56 & private & 220187 & 10 & married & male spouse & white &
male & 0 & 0 & 45 & \textgreater50k & some college & white collar &
north america & 46-60 \\
26044 & 42 & private & 177989 & 9 & married & male spouse & white & male
& 0 & 0 & 40 & \textless=50k & secondary-school graduate & blue collar &
north america & 36-45 \\
26441 & 58 & private & 205410 & 9 & married & male spouse & white & male
& 0 & 0 & 40 & \textless=50k & secondary-school graduate & blue collar &
north america & 46-60 \\
26572 & 33 & private & 136331 & 9 & married & male spouse & white & male
& 0 & 0 & 40 & \textless=50k & secondary-school graduate & blue collar &
north america & 26-35 \\
27921 & 43 & private & 174575 & 10 & divorced or separated & single &
white & male & 0 & 0 & 45 & \textless=50k & some college & white collar
& north america & 36-45 \\
28841 & 38 & private & 108907 & 9 & divorced or separated & single &
white & male & 0 & 0 & 40 & \textless=50k & secondary-school graduate &
blue collar & other & 36-45 \\
29225 & 27 & private & 183523 & 13 & single & single & white & male & 0
& 0 & 45 & \textless=50k & tertiary & white collar & north america &
26-35 \\
30132 & 25 & private & 367306 & 10 & single & child & white & female & 0
& 0 & 40 & \textless=50k & some college & white collar & north america &
18-25 \\
31760 & 25 & private & 182866 & 9 & single & child & white & male & 0 &
0 & 40 & \textless=50k & secondary-school graduate & blue collar & north
america & 18-25 \\
\end{longtable}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df}\OperatorTok{=}\NormalTok{ adult\_df.drop\_duplicates()}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.duplicated().}\BuiltInTok{sum}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
0
\end{verbatim}

The final shape of the clean dataset is thus \emph{32,513} rows and
\emph{16} columns.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{adult\_df.shape}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
(32513, 16)
\end{verbatim}

Finally, we save the clean, processed dataset as a CSV file in our
\texttt{processed} directory for future modelling and analysis.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# save the files in the processed data folder}
\NormalTok{final\_file}\OperatorTok{=}\NormalTok{ os.path.join(processed\_dir,}\StringTok{\textquotesingle{}adult\_cleaned.csv\textquotesingle{}}\NormalTok{)}
\NormalTok{adult\_df.to\_csv(final\_file, index}\OperatorTok{=}\VariableTok{False}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pwd}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
'C:\\Users\\Dione\\Downloads\\workshop\\adult\\notebooks'
\end{verbatim}




\end{document}
